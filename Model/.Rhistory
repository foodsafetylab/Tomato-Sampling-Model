}
TR20T<-Get_PP_df(PP2= PP2)
TR20T$Sampling<-"20 Tomatoes"
TR2T<-Get_PP_df(PP2= PP)
TR2T$Sampling<-"2 Tomatoes"
TR_All<-rbind(TR20T,TR2T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Days")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0101.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event Happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0101.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event appened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0101.tiff",width = 30, height = 20, units = "cm", dpi = 600)
PP<-read.csv("Data_Tomato_Outputs/PP11.csv")
PP2<-read.csv("Data_Tomato_Outputs/PP211.csv")
Get_PP_df<-function(PP2){
R1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
TR1<-T1%>%
bind_rows(R1) %>%
mutate(Pick = "PH sampling Pick 1")
R2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS),Prot_Rate = sum(X2)/sum(CFU_Bef_Pick2PHS)) %>%
mutate(class= "Total Available")
TR2<-T2%>%
bind_rows(R2) %>%
mutate(Pick = "PH sampling Pick 2")
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
TR3<-T3%>%
bind_rows(R3) %>%
mutate(Pick = "PH sampling Pick 3")
TR_Tog<-rbind(TR1,TR2,TR3)
return (TR_Tog)
}
TR20T<-Get_PP_df(PP2= PP2)
library(tidyverse)
library(scales)
library(forcats)
PP<-read.csv("Data_Tomato_Outputs/PP11.csv")
PP2<-read.csv("Data_Tomato_Outputs/PP211.csv")
Get_PP_df<-function(PP2){
R1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
TR1<-T1%>%
bind_rows(R1) %>%
mutate(Pick = "PH sampling Pick 1")
R2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS),Prot_Rate = sum(X2)/sum(CFU_Bef_Pick2PHS)) %>%
mutate(class= "Total Available")
TR2<-T2%>%
bind_rows(R2) %>%
mutate(Pick = "PH sampling Pick 2")
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
TR3<-T3%>%
bind_rows(R3) %>%
mutate(Pick = "PH sampling Pick 3")
TR_Tog<-rbind(TR1,TR2,TR3)
return (TR_Tog)
}
TR20T<-Get_PP_df(PP2= PP2)
TR20T$Sampling<-"20 Tomatoes"
TR2T<-Get_PP_df(PP2= PP)
TR2T$Sampling<-"2 Tomatoes"
TR_All<-rbind(TR20T,TR2T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0101.tiff",width = 30, height = 20, units = "cm", dpi = 600)
PP6<-read.csv("Data_Tomato_Outputs/PP311.csv")
TR6T<-Get_PP_df(PP= PP6)
TR6T$Sampling<-"6 Tomatoes"
TR_All<-rbind(TR20T,TR2T,TR6T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All<-rbind(TR2T,TR6T,TR20T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
PP60<-read.csv("Data_Tomato_Outputs/PP411.csv")
PP60<-read.csv("Data_Tomato_Outputs/PP411.csv")
TR60T<-Get_PP_df(PP= PP6)
TR60T$Sampling<-"60 Tomatoes"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR60T<-Get_PP_df(PP= PP60)
TR60T$Sampling<-"60 Tomatoes"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7,method = "lm")+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7,method = "glm")+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
#geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_line(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_line(aes(x = X6, y =Prot_Rate*10000000))+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_line(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 1, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
View(TR_All)
View(PP)
PP20M<-read.csv("Data_Tomato_Outputs/PP511.csv")
PP60M<-read.csv("Data_Tomato_Outputs/PP611.csv")
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T,TR20TM,TR60TM)
TR20TM<-Get_PP_df(PP= PP20M)
TR20TM$Sampling<-"20 Tomato Mash"
TR60TM<-Get_PP_df(PP= PP60M)
TR60TM$Sampling<-"60 Tomato Mash"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T,TR20TM,TR60TM)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 30, units = "cm", dpi = 600)
TR_All$Sampling<-factor(TR_All$Sampling, levels=c("2 Tomatoes", "20 Tomatoes", "6 Tomatoes", "60 Tomatoes", "20  Tomato Mash", "60 Tomato Mash"))
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 30, units = "cm", dpi = 600)
PP<-read.csv("Data_Tomato_Outputs/PP11.csv")
PP2<-read.csv("Data_Tomato_Outputs/PP211.csv")
PP6<-read.csv("Data_Tomato_Outputs/PP311.csv")
PP60<-read.csv("Data_Tomato_Outputs/PP411.csv")
PP20M<-read.csv("Data_Tomato_Outputs/PP511.csv")
PP60M<-read.csv("Data_Tomato_Outputs/PP611.csv")
Get_PP_df<-function(PP2){
R1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
TR1<-T1%>%
bind_rows(R1) %>%
mutate(Pick = "PH sampling Pick 1")
R2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS),Prot_Rate = sum(X2)/sum(CFU_Bef_Pick2PHS)) %>%
mutate(class= "Total Available")
TR2<-T2%>%
bind_rows(R2) %>%
mutate(Pick = "PH sampling Pick 2")
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
TR3<-T3%>%
bind_rows(R3) %>%
mutate(Pick = "PH sampling Pick 3")
TR_Tog<-rbind(TR1,TR2,TR3)
return (TR_Tog)
}
TR20T<-Get_PP_df(PP2= PP2)
TR20T$Sampling<-"20 Tomatoes"
TR2T<-Get_PP_df(PP2= PP)
TR2T$Sampling<-"2 Tomatoes"
TR6T<-Get_PP_df(PP= PP6)
TR6T$Sampling<-"6 Tomatoes"
TR60T<-Get_PP_df(PP= PP60)
TR60T$Sampling<-"60 Tomatoes"
TR20TM<-Get_PP_df(PP= PP20M)
TR20TM$Sampling<-"20 Tomato Mash"
TR60TM<-Get_PP_df(PP= PP60M)
TR60TM$Sampling<-"60 Tomato Mash"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T,TR20TM,TR60TM)
TR_All$Sampling<-factor(TR_All$Sampling, levels=c("2 Tomatoes", "20 Tomatoes", "6 Tomatoes", "60 Tomatoes", "20 Tomato Mash", "60 Tomato Mash"))
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 30, units = "cm", dpi = 600)
View(TR_All)
View(PP)
View(TR20T)
View(PP2)
PP2 %>%
melt()
library(reshape2)
PP2 %>%
melt()
View(TR20TM)
PP2 %>%
group_by(Pick) %>%
summarize(PP = Total_CFU[class=="Total Available"]/Total_CFU[class=="Total Rejected"])
TR20TM %>%
group_by(Pick) %>%
summarize(PP = Total_CFU[class=="Total Available"]/Total_CFU[class=="Total Rejected"])
TR20TM %>%
group_by(Pick) %>%
summarize(PP = total[class=="Total Available"]/total[class=="Total Rejected"])
TR20TM %>%
group_by(Pick) %>%
summarize(PP = sum(total[class=="Total Available"])/sum(total[class=="Total Rejected"]))
TR20TM %>%
group_by(Pick) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"]))
View(TR_All)
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"]))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point()
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge())
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge(width = 3))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge(width = 0.5))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge(width = 0.3))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_col()
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, fill = Sampling))+
geom_col()
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, fill = Sampling))+
geom_col(position = position_dodge())
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, fill = Sampling))+
geom_col(position = position_dodge())+
ylab("Protection power per pick")
