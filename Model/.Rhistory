summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS),Prot_Rate = sum(X2)/sum(CFU_Bef_Pick2PHS)) %>%
mutate(class= "Total Available")
TR2<-T2%>%
bind_rows(R2) %>%
mutate(Pick = "PH sampling Pick 2")
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
TR3<-T3%>%
bind_rows(R3) %>%
mutate(Pick = "PH sampling Pick 3")
TR_Tog<-rbind(TR1,TR2,TR3)
return (TR_Tog)
}
TR20T<-Get_PP_df(PP2= PP2)
TR20T$Sampling<-"20 Tomatoes"
TR2T<-Get_PP_df(PP2= PP)
TR2T$Sampling<-"2 Tomatoes"
TR_All<-rbind(TR20T,TR2T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0101.tiff",width = 30, height = 20, units = "cm", dpi = 600)
PP6<-read.csv("Data_Tomato_Outputs/PP311.csv")
TR6T<-Get_PP_df(PP= PP6)
TR6T$Sampling<-"6 Tomatoes"
TR_All<-rbind(TR20T,TR2T,TR6T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All<-rbind(TR2T,TR6T,TR20T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
PP60<-read.csv("Data_Tomato_Outputs/PP411.csv")
PP60<-read.csv("Data_Tomato_Outputs/PP411.csv")
TR60T<-Get_PP_df(PP= PP6)
TR60T$Sampling<-"60 Tomatoes"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*2000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./2000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR60T<-Get_PP_df(PP= PP60)
TR60T$Sampling<-"60 Tomatoes"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7)+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7,method = "lm")+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7,method = "glm")+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
#geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_line(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_line(aes(x = X6, y =Prot_Rate*10000000))+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_line(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7 )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.3, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 1, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
View(TR_All)
View(PP)
PP20M<-read.csv("Data_Tomato_Outputs/PP511.csv")
PP60M<-read.csv("Data_Tomato_Outputs/PP611.csv")
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T,TR20TM,TR60TM)
TR20TM<-Get_PP_df(PP= PP20M)
TR20TM$Sampling<-"20 Tomato Mash"
TR60TM<-Get_PP_df(PP= PP60M)
TR60TM$Sampling<-"60 Tomato Mash"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T,TR20TM,TR60TM)
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 20, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 30, units = "cm", dpi = 600)
TR_All$Sampling<-factor(TR_All$Sampling, levels=c("2 Tomatoes", "20 Tomatoes", "6 Tomatoes", "60 Tomatoes", "20  Tomato Mash", "60 Tomato Mash"))
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 30, units = "cm", dpi = 600)
PP<-read.csv("Data_Tomato_Outputs/PP11.csv")
PP2<-read.csv("Data_Tomato_Outputs/PP211.csv")
PP6<-read.csv("Data_Tomato_Outputs/PP311.csv")
PP60<-read.csv("Data_Tomato_Outputs/PP411.csv")
PP20M<-read.csv("Data_Tomato_Outputs/PP511.csv")
PP60M<-read.csv("Data_Tomato_Outputs/PP611.csv")
Get_PP_df<-function(PP2){
R1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
TR1<-T1%>%
bind_rows(R1) %>%
mutate(Pick = "PH sampling Pick 1")
R2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP2 %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS),Prot_Rate = sum(X2)/sum(CFU_Bef_Pick2PHS)) %>%
mutate(class= "Total Available")
TR2<-T2%>%
bind_rows(R2) %>%
mutate(Pick = "PH sampling Pick 2")
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
TR3<-T3%>%
bind_rows(R3) %>%
mutate(Pick = "PH sampling Pick 3")
TR_Tog<-rbind(TR1,TR2,TR3)
return (TR_Tog)
}
TR20T<-Get_PP_df(PP2= PP2)
TR20T$Sampling<-"20 Tomatoes"
TR2T<-Get_PP_df(PP2= PP)
TR2T$Sampling<-"2 Tomatoes"
TR6T<-Get_PP_df(PP= PP6)
TR6T$Sampling<-"6 Tomatoes"
TR60T<-Get_PP_df(PP= PP60)
TR60T$Sampling<-"60 Tomatoes"
TR20TM<-Get_PP_df(PP= PP20M)
TR20TM$Sampling<-"20 Tomato Mash"
TR60TM<-Get_PP_df(PP= PP60M)
TR60TM$Sampling<-"60 Tomato Mash"
TR_All<-rbind(TR2T,TR6T,TR20T,TR60T,TR20TM,TR60TM)
TR_All$Sampling<-factor(TR_All$Sampling, levels=c("2 Tomatoes", "20 Tomatoes", "6 Tomatoes", "60 Tomatoes", "20 Tomato Mash", "60 Tomato Mash"))
TR_All%>%
ggplot()+
geom_col(aes(x = X6, y = total,fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.5, size = 1)+
geom_smooth(aes(x = X6, y =Prot_Rate*10000000), alpha = 0.1,span = 0.9, size = 0.7, se=F )+
scale_y_continuous(labels = scales::comma,sec.axis = sec_axis(~./10000000, name = 'Protection Power'))+
xlab("Day where contamination event happened")+
ylab("Tota Adulterant Cells (TAC)")+
facet_grid(Sampling~Pick, scales = "free_x")+
scale_fill_discrete("Contamination Outcome")
ggsave(filename="Plot Outputs/PP0111.tiff",width = 30, height = 30, units = "cm", dpi = 600)
View(TR_All)
View(PP)
View(TR20T)
View(PP2)
PP2 %>%
melt()
library(reshape2)
PP2 %>%
melt()
View(TR20TM)
PP2 %>%
group_by(Pick) %>%
summarize(PP = Total_CFU[class=="Total Available"]/Total_CFU[class=="Total Rejected"])
TR20TM %>%
group_by(Pick) %>%
summarize(PP = Total_CFU[class=="Total Available"]/Total_CFU[class=="Total Rejected"])
TR20TM %>%
group_by(Pick) %>%
summarize(PP = total[class=="Total Available"]/total[class=="Total Rejected"])
TR20TM %>%
group_by(Pick) %>%
summarize(PP = sum(total[class=="Total Available"])/sum(total[class=="Total Rejected"]))
TR20TM %>%
group_by(Pick) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"]))
View(TR_All)
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"]))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point()
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge())
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge(width = 3))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge(width = 0.5))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_point(position = position_dodge(width = 0.3))
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, color = Sampling))+
geom_col()
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, fill = Sampling))+
geom_col()
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, fill = Sampling))+
geom_col(position = position_dodge())
TR_All %>%
group_by(Pick, Sampling) %>%
summarize(PP = sum(total[class=="Total Rejected"])/sum(total[class=="Total Available"])) %>%
ggplot(aes(x = Pick, y = PP, fill = Sampling))+
geom_col(position = position_dodge())+
ylab("Protection power per pick")
library(tidyverse)
library(scales)
library(forcats)
library(tidyverse)
library(scales)
library(forcats)
Powers<-read.csv("Data_Tomato_Outputs/Powers_Out_Rep.csv")
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers<-read.csv("Data_Tomato_Outputs/Powers_Out_Rep.csv")
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = median(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
Powers_Summary$Cont<-factor(Powers_Summary$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary %>%
ggplot(aes(x = Type, y = mean, color = Mass,shape = variable ,group = interaction(Mass, variable)))+
#geom_point(stroke = 4,position = position_dodge(0.3))+
#geom_line(aes(linetype= variable),size = 0.3,position = position_dodge(0.3))+
geom_pointrange(aes(ymin=CI_05, ymax=CI_95),position = position_dodge(0.5), size = 0.5)+
geom_errorbar(aes(ymin=CI_05, ymax=CI_95),width = 0.5, size =0.5,position = position_dodge(0.5))+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
#scale_size_manual(name = "Tomatoes Sampled")+
scale_color_discrete(name="Sampling Plan")+
scale_shape_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3") )+
scale_linetype_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3"))+
facet_wrap(~Cont,nrow = 2)+
theme_bw()
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2)+
theme_bw()
Powers %>%
group_by(Type, Mass,Cont) %>%
summarise(mean = mean(value), q95 = quantile(value, 0.95), q05 = quantile(value, 0.05))
write.csv(x = Powers_summary_qs, file = "Powers Summary.csv")
#Summary
Powers_summary_qs<-Powers %>%
group_by(Type, Mass,Cont) %>%
summarise(mean = mean(value), q95 = quantile(value, 0.95), q05 = quantile(value, 0.05))
write.csv(x = Powers_summary_qs, file = "Powers Summary.csv")
Spread_names <- list(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=Spread_names)+
theme_bw()
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
Spread_names <-c(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
#ggsave(filename="Plot Outputs/Powers1011.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Powers1011.png",width = 25, height = 15, units = "cm", dpi = 600)
