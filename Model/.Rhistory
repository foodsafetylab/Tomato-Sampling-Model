Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`)+
scale_y_continuous(labels = scales::comma)+
theme_bw()
library(tidyverse)
library(scales)
library(forcats)
PP<-read.csv("Data_Tomato_Outputs/PP10.csv")
PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2)) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4)) %>%
bind_rows(PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0))) %>%
bind_rows(  PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
PP %>%
filter(X1 == "No")
PP %>%
filter(X1 == "No")
PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS)) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS))
PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available") %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
R1<-PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
T1%>%
bind_rows(R1)
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, color = class))+
geom_col()+
scale_y_continuous(labels = scales::comma)
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, color = class))+
geom_col(position = position_identity())+
scale_y_continuous(labels = scales::comma)
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, fill = class))+
geom_col(position = position_identity())+
scale_y_continuous(labels = scales::comma)
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, fill = class))+
geom_col(position = position_identity(), alpha = 0.5)+
scale_y_continuous(labels = scales::comma)
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS))%>%
mutate(class= "Total Rejected")
T2%>%
bind_rows(R2) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
T2%>%
bind_rows(R2) %>%
ggplot(aes(x = X6, y = total))+
geom_col()+
scale_y_continuous(labels = scales::comma)
R2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS))%>%
mutate(class= "Total Rejected")
T2%>%
bind_rows(R2) %>%
ggplot(aes(x = X6, y = total))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T2%>%
bind_rows(R2) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS))%>%
mutate(class= "Total Available")
T2%>%
bind_rows(R2) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS))%>%
mutate(class= "Total Available")
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
PP2<-read.csv("Data_Tomato_Outputs/PP210.csv")
PP<-read.csv("Data_Tomato_Outputs/PP10.csv")
R1<-PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T1<-PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS)) %>%
summarize (Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
T1<-PP %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total, fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~Prot_Rate, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~Prot_Rate, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~1, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(0:1, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./10000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./100000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./100000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./1000000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./1000000*Prot_Rate , name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./1000000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total))+
geom_col(aes( fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./1000000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot(aes(x = X6, y = total))+
geom_col(aes( fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(    # Features of the first axis
name = "First Axis",
# Add a second axis and specify its features
sec.axis = sec_axis(~./1000000, name="Second Axis"))
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
geom_point(aes(x =X6, y = Prot_Rate ))+
scale_y_continuous(labels = scales::comma)
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X0)) %>%
mutate(class= "Total Rejected")
T1<-PP2 %>%
filter(X1 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick1PHS),Prot_Rate = sum(X0)/sum(CFU_Bef_Pick1PHS)) %>%
mutate(class= "Total Available")
T1%>%
bind_rows(R1) %>%
ggplot()+
geom_col(aes(x = X6, y = total, fill = class),position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X2))%>%
mutate(class= "Total Rejected")
T2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS))%>%
mutate(class= "Total Available")
T2%>%
bind_rows(R2) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS))%>%
mutate(class= "Total Available")
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T1 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()
T1 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_line()
T2 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_line()
T2<-PP %>%
filter(X3 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick2PHS),Prot_Rate = sum(X2)/sum(CFU_Bef_Pick2PHS)) %>%
mutate(class= "Total Available")
T2 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_line()
R3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T3 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_line()
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T3 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_line()
T3 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_smooth()
R3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T3 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_smooth()
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T3 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_smooth()
R3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(X4))%>%
mutate(class= "Total Rejected")
T3<-PP2 %>%
filter(X5 == "No") %>%
group_by(X6) %>%
summarize(total =sum(CFU_Bef_Pick3PHS),Prot_Rate = sum(X4)/sum(CFU_Bef_Pick3PHS)) %>%
mutate(class= "Total Available")
T3%>%
bind_rows(R3) %>%
ggplot(aes(x = X6, y = total,fill = class))+
geom_col(position = position_identity(), alpha = 0.9)+
scale_y_continuous(labels = scales::comma)
T3 %>%
ggplot(aes(x = X6, y =Prot_Rate))+
geom_point()+
geom_smooth()
